<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width" />
	<title>DataTables - Excel Download, Fixed Header, Fixed Column Sample</title>
	
	<!-- DataTables CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.3/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/2.3.0/css/dataTables.bootstrap5.min.css">

	<!-- Responsive -->
	<link rel="stylesheet" href="https://cdn.datatables.net/responsive/3.0.4/css/responsive.bootstrap5.css">

	<!-- FixedHeader CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/4.0.1/css/fixedHeader.dataTables.min.css"/>
	<link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/4.0.1/css/fixedHeader.bootstrap5.css"/>

	<!-- FixedColumns CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/fixedcolumns/5.0.4/css/fixedColumns.dataTables.min.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/fixedcolumns/5.0.4/css/fixedColumns.bootstrap5.css"/>

	<!-- Buttons -->
	<link rel="stylesheet" href="https://cdn.datatables.net/buttons/3.2.3/css/buttons.dataTables.css"/>

	<link rel="stylesheet" href="./css/dataTables05.css">
</head>

<body>
	<div class="container">
		<h1 class="mb-lg-2">DataTables: 엑셀 다운로드, 고정헤더, 고정칼럼</h1>
		<div class="table-responsive" id="sampleCode">
			
		</div>
	</div>

	<!-- jQuery -->
	<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>
	
	<!-- DataTables Basic -->
	<script src="https://cdn.datatables.net/2.3.0/js/dataTables.js"></script>
	<script src="https://cdn.datatables.net/2.3.0/js/dataTables.bootstrap5.js"></script>

	<!-- Responsive -->
	<script src="https://cdn.datatables.net/responsive/3.0.4/js/dataTables.responsive.js"></script>
	<script src="https://cdn.datatables.net/responsive/3.0.4/js/responsive.bootstrap5.js"></script>
	
	<!-- FixedHeader JS -->
	<script type="text/javascript" src="https://cdn.datatables.net/fixedheader/4.0.1/js/dataTables.fixedHeader.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/fixedheader/4.0.1/js/fixedHeader.bootstrap5.min.js"></script>
	
	<!-- FixedColumns JS -->
	<script src="https://cdn.datatables.net/fixedcolumns/5.0.4/js/dataTables.fixedColumns.min.js"></script>
	<script src="https://cdn.datatables.net/fixedcolumns/5.0.4/js/fixedColumns.bootstrap5.min.js"></script>

	<!-- Buttons -->
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/dataTables.buttons.js"></script>
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/buttons.bootstrap5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/buttons.html5.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/buttons.print.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/buttons.colVis.min.js"></script>
	
	<script>
		// 1. 공통 옵션 객체를 전역(혹은 상위 스코프)에 정의
		const COMMON_DATATABLES_OPTIONS = {
			responsive: true,
			scrollCollapse: true,
			scrollX: true,
			scrollY: 480,
			fixedHeader: true,
			fixedColumns: { leftColumns: 1 },
			buttons: [
				'copy', 'excel', 'pdf'
			],
			paging: true,
			lengthMenu: [[10, 25, 100, -1], [10, 25, 100, "All"]],
			pageLength: 10,
			layout: {
				topStart: 'buttons',
				topEnd: 'search',         // 상단 오른쪽: 검색창
				bottomStart: 'pageLength',      // 하단 왼쪽: 정보(몇 개 중 몇 개 표시)
				bottomEnd: {
					paging: {
						boundaryNumbers: false,
						firstLast: false,
						previousNext: false,
						type: 'numbers'
					}
				}
			},
			language: {
				search: "테이블 검색",
				lengthMenu: "한 화면에 표시할 항목 수: _MENU_개",
				info: "총 _TOTAL_건 중 _START_~_END_건 표시"
			}
		};

		// 2. 범용 적용 함수
		function applyDataTablesToTarget(targetSelector, customOptions = {}) {
			$(`${targetSelector} table`).each(function() {
				// 이미 DataTable이 적용된 경우 destroy 후 재초기화
				if ($.fn.DataTable.isDataTable(this)) {
					$(this).DataTable().destroy();
				}
				// 공통 옵션과 개별 옵션을 합쳐서 적용
				$(this).DataTable(Object.assign(
					{ destroy: true }, // 항상 destroy 옵션 추가
					COMMON_DATATABLES_OPTIONS, // 공통 옵션
					customOptions // 필요시 개별 옵션 덮어쓰기
				));
			});
		}
		
		// 3. 사용 예시
		$(document).ready(function () {
			// load sample table
			$.ajax({
				url: './sample/_table.html',
				type: 'GET',
				success: function(data) {
					$('#sampleCode').html(data);
					
					// 필요하다면 개별 옵션도 추가 가능
					applyDataTablesToTarget('#sampleCode', {
					// pageLength: 20, // 예시: 개별 옵션
					});
				}
			});
		});
	</script>
</body>

</html>