<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width" />
	<title>DataTables - Excel Download, Fixed Header, Fixed Column Sample</title>
	
	<!-- DataTables CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/2.3.0/css/dataTables.bootstrap5.min.css">
	<link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css">

	<!-- Buttons extension CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/buttons/3.2.3/css/buttons.bootstrap5.min.css">

	<!-- FixedHeader extension CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/4.0.1/css/fixedHeader.bootstrap5.min.css">

	<!-- FixedColumns extension CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/fixedcolumns/5.0.4/css/fixedColumns.bootstrap5.min.css">

	<!-- Responsive -->
	<link rel="stylesheet" href="https://cdn.datatables.net/responsive/3.0.4/css/responsive.bootstrap5.min.css">

	<!-- Font Awesome for icon -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="./css/dataTables02.css">
</head>

<body>
	<div class="container">
		<h2>DataTables: 엑셀 다운로드, 고정헤더, 고정칼럼</h2>
		<div class="info-and-select">
			<div class="row g-2">
				<label for="pageSelect" class="col-sm-auto col-form-label">페이지 이동:</label>
				<div class="col-sm">
					<select id="pageSelect" class="form-select"></select>
				</div>
			</div>
		</div>
		<table id="example" class="display responsive nowrap" style="width:100%">
			<thead>
				<tr>
					<th>고정1</th>
					<th>고정2</th>
					<th>데이터1</th>
					<th>데이터2</th>
					<th>데이터3</th>
					<th>데이터4</th>
					<th>데이터5</th>
					<th>데이터6</th>
					<th>데이터7</th>
					<th>데이터8</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>A1</td>
					<td>B1</td>
					<td>C1</td>
					<td>D1</td>
					<td>E1</td>
					<td>F1</td>
					<td>G1</td>
					<td>H1</td>
					<td>I1</td>
					<td>J1</td>
				</tr>
				<tr>
					<td>A2</td>
					<td>B2</td>
					<td>C2</td>
					<td>D2</td>
					<td>E2</td>
					<td>F2</td>
					<td>G2</td>
					<td>H2</td>
					<td>I2</td>
					<td>J2</td>
				</tr>
				<tr>
					<td>A3</td>
					<td>B3</td>
					<td>C3</td>
					<td>D3</td>
					<td>E3</td>
					<td>F3</td>
					<td>G3</td>
					<td>H3</td>
					<td>I3</td>
					<td>J3</td>
				</tr>
				<tr>
					<td>A4</td>
					<td>B4</td>
					<td>C4</td>
					<td>D4</td>
					<td>E4</td>
					<td>F4</td>
					<td>G4</td>
					<td>H4</td>
					<td>I4</td>
					<td>J4</td>
				</tr>
				<tr>
					<td>A5</td>
					<td>B5</td>
					<td>C5</td>
					<td>D5</td>
					<td>E5</td>
					<td>F5</td>
					<td>G5</td>
					<td>H5</td>
					<td>I5</td>
					<td>J5</td>
				</tr>
			</tbody>
		</table>
	</div>

	<!-- jQuery -->
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://cdn.datatables.net/2.3.0/js/dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/2.3.0/js/dataTables.bootstrap5.min.js"></script>

	<!-- Buttons extension JS + Excel export -->
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/dataTables.buttons.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/buttons.bootstrap5.min.js"></script>

	<!-- Column visibility -->
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/buttons.colVis.min.js"></script>

	<!-- Print button: -->
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/buttons.print.min.js"></script>

	<!-- HTML5 export  -->
	<script src="https://cdn.datatables.net/buttons/3.2.3/js/buttons.html5.min.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

	<!-- FixedHeader extension JS -->
	<script src="https://cdn.datatables.net/fixedheader/4.0.1/js/dataTables.fixedHeader.min.js"></script>
	<script src="https://cdn.datatables.net/fixedheader/4.0.1/js/fixedHeader.bootstrap5.min.js"></script>
	
	<!-- FixedColumns extension JS -->
	<script src="https://cdn.datatables.net/fixedcolumns/5.0.4/js/dataTables.fixedColumns.min.js"></script>
	<script src="https://cdn.datatables.net/fixedcolumns/5.0.4/js/fixedColumns.bootstrap5.min.js"></script>

	<!-- Responsive -->
	<script src="https://cdn.datatables.net/responsive/3.0.4/js/dataTables.responsive.min.js"></script>
	<script src="https://cdn.datatables.net/responsive/3.0.4/js/responsive.bootstrap5.min.js"></script>
	
	<script>
		$(document).ready(function () {
			var table = $('#example').DataTable({
				responsive: true,
				scrollX: true,
				scrollY: 300,
				fixedHeader: true,
				fixedColumns: {
					leftColumns: 2 // 좌측 2개 열 고정
				},
				buttons: [
					{
						extend: 'excelHtml5',
						text: '<i class="fas fa-file-excel"></i> 엑셀 다운로드',
						className: 'btn-excel',
						title: '직원목록_엑셀_내보내기',
						exportOptions: {
							columns: [0, 1, 2, 3] // 숨은 열도 포함하려면 명시적으로 지정
							// columns: ':visible' 하면 숨은 열 제외
						},
						filename: '직원목록_내보내기' // 저장되는 파일명 (확장자 자동 추가됨)
					}
				],
				paging: true,
				lengthMenu: [[3, 10, 25, 100, -1], [3, 10, 25, 100, "All"]],
				pageLength: 3,
				pagingType: 'simple',
				layout: {
					topStart: 'info',   // 상단 왼쪽: 페이지당 행 수 선택
					topEnd: 'search',         // 상단 오른쪽: 검색창
					bottomStart: 'pageLength',      // 하단 왼쪽: 정보(몇 개 중 몇 개 표시)
					bottom2Start: 'info',      // 하단 왼쪽: 정보(몇 개 중 몇 개 표시)
					bottomEnd: 'paging'       // 하단 오른쪽: 페이징 버튼
				},
				language: {
					search: "테이블 검색",
					lengthMenu: "한 화면에 표시할 항목 수: _MENU_개",
					info: "총 _TOTAL_건 중 _START_~_END_건 표시"
				}
			});

			$('.dataTables_paginate').prepend($('.info-and-select'));
			$('.dataTables_paginate').find('.paginate_button').hide();
			$('.dataTables_length select').addClass('form-select');

			// 페이지 이동 셀렉트박스
			function updatePageSelect() {
				var info = table.page.info();
				var $select = $('#pageSelect');
				$select.empty();
				for (var i = 0; i < info.pages; i++) {
					$select.append('<option value="' + i + '">' + (i + 1) + ' / ' + info.pages + '</option>');
				}
				$select.val(info.page); // 현재 페이지 선택

				// 페이지가 2개 이상일 때만 표시
				if (info.pages > 1) {
					$('.info-and-select').show();
				} else {
					$('.info-and-select').hide();
				}
			}

			// 테이블이 그려질 때마다 셀렉트박스 갱신
			table.on('draw', function () {
				updatePageSelect();
			});

			$('#pageSelect').on('change', function () {
				var pageNum = parseInt($(this).val(), 10);
				table.page(pageNum).draw(false);
			});

			updatePageSelect();
			// 최초 info 영역에 append
		});
	</script>
</body>

</html>